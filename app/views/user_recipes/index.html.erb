<div class="recipes-container">

  <div class="recipes-navbar">
    <h4 class="recipe-navbar-active" id="completedBtn">Completed Recipes</h4>
    <h4 id="unlockedBtn">Unlocked Recipes</h4>
  </div>

  <%= render 'unlocked' %>

  <div class="recipes-cards-container" id="completedRecipes">
    <% @completed_recipes.each do |user_recipe| %>

      <div class="recipe-diary-modal userRecipe<%= user_recipe.id %>">
        <% validation = LessonValidation.find_by(user: current_user, lesson: user_recipe.recipe.lessons.first) %>

        <div class="recipe-diary-modal-content">
          <%= image_tag('btn-close-rounded.svg', class: 'recipe-diary-modal-close-btn') %>

          <h1>Recipe Diary Entry</h1>
          <h2><%= user_recipe.recipe.title %></h2>

          <ul class="recipe-diary-details">
            <li>
              <%= image_tag('validation-date.svg') %>
              <%= validation.created_at.strftime("%d/%m/%y") %>
            </li>
            <li>
              <%= image_tag('validation-time.svg') %>
              <%= user_recipe.recipe.prep_time %>
            </li>
            <li>
              <%= image_tag('validation-level.svg') %>
              Level <%= Book.levels[validation.lesson.book.level] %>
            </li>
          </ul>

          <div class="recipe-diary-overview">
            <div class="feedback mr-1">
              <h3>Your feedback</h3>
              <% if validation.difficulcy %>
                <div class="difficulcy-feedback">
                  <%= image_tag("lesson-validation-icon-#{validation.difficulcy}.svg") %>
                  <% if validation.difficulcy == 'easy' %>
                    <p>"Piece of cake"</p>
                  <% elsif validation.difficulcy == 'medium' %>
                    <p>"Just right"</p>
                  <% else %>
                    <p>"Burnt it all"</p>
                  <% end %>
                </div>
              <% else %>
                <p class="mt-3">No feedback</p>
              <% end %>
            </div>
            <div class="expert-review ml-1">
              <h3>Expert review</h3>
              <h4>?</h4>
            </div>
          </div>

          <div class="recipe-diary-notes">
            <h3>Your notes</h3>
            <% if validation.notes.empty? %>
              <p>Looks like you didn't leave any notes :(</p>
            <% else %>
              <p><%= validation.notes %></p>
            <% end %>
          </div>

          <%= link_to "Make this recipe again", lesson_path(Lesson.find_by(recipe: user_recipe.recipe)), class: 'primary-btn' %>
        </div>
      </div>

      <div class="recipe-card" id="userRecipe<%= user_recipe.id %>">
        <div class="recipe-card-image" style="background-image: linear-gradient(rgba(0,0,0,0), rgba(0,0,0,.4)), url('<%= image_path("#{user_recipe.recipe.photo_url}") %>')">
          <div class="recipe-card-info">
            <% if user_recipe.recipe.external_url %>
              <%= image_tag('recipe-url.svg') %>
              <p>External link</p>
            <% else %>
              <%= image_tag('recipe-time.svg') %>
              <p><%= user_recipe.recipe.prep_time %></p>
            <% end %>
          </div>
        </div>
        <p><%= user_recipe.recipe.title %></p>
      </div>

    <% end %>
  </div>

</div>

